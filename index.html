<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Read Data from templated Excel Data Reports • excelDataGuide</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Read Data from templated Excel Data Reports">
<meta name="description" content="Provides functions as well as a YAML guide format to facilitate reading data from filled-out excel templates. In particular, the package provides such facilities for experiments performed with microplates.">
<meta property="og:description" content="Provides functions as well as a YAML guide format to facilitate reading data from filled-out excel templates. In particular, the package provides such facilities for experiments performed with microplates.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">excelDataGuide</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/writing_templates_and_data_guides.html">writing_templates_and_data_guides</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/douwe/excelDataGuide/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="exceldataguide">excelDataGuide<a class="anchor" aria-label="anchor" href="#exceldataguide"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p><strong>excelDataGuide</strong> is an R package designed to streamline the process of importing data from spreadsheet <em>data reporting templates</em> (DRTs) into R.</p>
<p>A <em>data reporting template</em> is a standardized spreadsheet file (in either xls or xlsx format) used for reporting and processing experimental data. These templates significantly reduce the time required for data analysis and encourage users to present their data in a structured format, minimizing errors and misinterpretations.</p>
<p>The <strong>excelDataGuide</strong> package eliminates the need for data analysts to write and maintain complex code for reading data from various complex spreadsheet DRTs. Additionally, it offers a robust framework for validating data, ensuring that the correct data types are utilized, and facilitating data wrangling when necessary. This functionality supports <em>Interoperability</em> for DRTs, a key aspect of the <a href="https://www.go-fair.org/fair-principles/" class="external-link">FAIR</a> principles.</p>
<p>The package features a user-friendly interface for extracting data from Excel files and converting it into R objects. It accommodates three types of data structures: key-value pairs, tabular data, and microplate-formatted data. The locations of these structures within the Excel template are specified by a <strong>data guide</strong>, which is a YAML file — a structured format that is both human- and machine-readable.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of excelDataGuide in a recent version of R from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"SystemsBioinformatics/excelDataGuide"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>The basic usage of the package requires only one command with two file paths: the path to the Excel data file and the path to the data guide file. Here is an example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://systemsbioinformatics.github.io/excelDataGuide/">excelDataGuide</a></span><span class="op">)</span></span>
<span><span class="va">datafile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_data.xlsx"</span>, package <span class="op">=</span> <span class="st">"excelDataGuide"</span><span class="op">)</span></span>
<span><span class="va">guidefile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_guide.yml"</span>, package <span class="op">=</span> <span class="st">"excelDataGuide"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_data.html">read_data</a></span><span class="op">(</span><span class="va">datafile</span>, <span class="va">guidefile</span><span class="op">)</span></span></code></pre></div>
<p>The output of the <code><a href="reference/read_data.html">read_data()</a></code> function is a list object the format of which is determined for a large part by the design of the data guide.</p>
</div>
<div class="section level2">
<h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
<div class="section level3">
<h3 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<p>When you design a template Excel file for data reporting and analysis you also create a <em>data guide</em> file that specifies the structure and location of the data in the template. If you design the template carefully you can use the same data guide for several versions of the template. That is, as long as the location of the indexed data does not change, you can use the same data guide for different versions of the template. You can specify the compatible version of the templates in the <em>data guide</em>. The package will check compatibility. Clearly, you should use versioned data templates, and hence, a required field in a template is its version number. An example of a template with data is provided in the package (<code>system.file("extdata", "example_data.xlsx", package = "excelDataGuide")</code>).</p>
<p>Once you have entered the data and metadata in a template you can use the package to extract the data into R. The package will check and coerce the data types to the required formats.</p>
</div>
<div class="section level3">
<h3 id="data-guide">Data guide<a class="anchor" aria-label="anchor" href="#data-guide"></a>
</h3>
<p>The <em>data guide</em> is a human readable and editable file in <a href="https://yaml.org/spec/1.2.2/" class="external-link">YAML</a> format that specifies the structure and location of the data in the Excel file. It contains a list of data types, each of which is defined by a name and a set of parameters. As the name suggests, the <em>data guide</em> is used by the <strong>excelDataGuide</strong> package as a guide to extract all indexed data from the Excel file and convert it into proper R objects. Part of the <em>data guide</em> from the example in the package, <em>i.e.</em> <code>system.file("extdata", "example_guide.yml", package = "excelDataGuide")</code> is shown below:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">guide.version</span><span class="kw">:</span><span class="at"> </span><span class="st">'1.0'</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">template.name</span><span class="kw">:</span><span class="at"> competition</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">template.min.version</span><span class="kw">:</span><span class="at"> </span><span class="st">'9.3'</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">template.max.version</span><span class="kw">:</span><span class="at"> </span><span class="ch">~</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">plate.format</span><span class="kw">:</span><span class="at"> </span><span class="dv">96</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">locations</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">sheet</span><span class="kw">:</span><span class="at"> description</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> cells</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="at">    </span><span class="fu">varname</span><span class="kw">:</span><span class="at"> .template</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="at">    </span><span class="fu">translate</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> version</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="at">        </span><span class="fu">cell</span><span class="kw">:</span><span class="at"> B2</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">sheet</span><span class="kw">:</span><span class="at"> description</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> keyvalue</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="at">    </span><span class="fu">translate</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="at">    </span><span class="fu">atomicclass</span><span class="kw">:</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> date</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="at">    </span><span class="fu">varname</span><span class="kw">:</span><span class="at"> metadata</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="at">    </span><span class="fu">ranges</span><span class="kw">:</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> A10:B21</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> A24:B25</span></span></code></pre></div>
<p>We provide a json schema for the data guide, allowing you to check the validity of guides that you wrote. The schema is available in the package as <code>system.file("extdata", "excelguide_schema.json", package = "excelDataGuide")</code>. To check its validity against the schema you can use the <a href="https://www.npmjs.com/package/pajv" class="external-link">Polyglottal JSON Schema Validator</a>. More details can be found in the vignette (to be done, see below).</p>
</div>
</div>
<div class="section level2">
<h2 id="future-work">Future work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<ul>
<li>Complete the vignette (<a href="https://github.com/SystemsBioinformatics/excelDataGuide/issues/2" class="external-link">issue</a>)</li>
<li>Provide guide and template structures for data types without upper size limit, typically time series with no pre-determined length (<a href="https://github.com/SystemsBioinformatics/excelDataGuide/issues/1" class="external-link">issue</a>).</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/douwe/excelDataGuide/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/douwe/excelDataGuide/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing excelDataGuide</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Douwe Molenaar <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7108-4545" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douwe Molenaar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
