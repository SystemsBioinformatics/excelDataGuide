<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>writing_templates_and_data_guides • excelDataGuide</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="writing_templates_and_data_guides">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">excelDataGuide</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/writing_templates_and_data_guides.html">writing_templates_and_data_guides</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/douwe/excelDataGuide/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>writing_templates_and_data_guides</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/douwe/excelDataGuide/blob/main/vignettes/writing_templates_and_data_guides.Rmd" class="external-link"><code>vignettes/writing_templates_and_data_guides.Rmd</code></a></small>
      <div class="d-none name"><code>writing_templates_and_data_guides.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Spreadsheets are widely used in biochemical laboratories for both
recording and analyzing experiments. When experiments become routine,
spreadsheet templates are often created to streamline workflows and
ensure consistency.</p>
<p>The goal of the <strong>excelDataGuide</strong> package is to enable
the use of Excel spreadsheets alongside scripting environments as
effective data analysis tools. While scripting languages offer more
flexibility and power—especially for analyzing large datasets across
multiple workbooks—the spreadsheet remains the <strong>primary source of
all data</strong>.</p>
<p>This <strong>“single-source-of-truth”</strong> approach ensures that
both spreadsheet-based and script-based analyses rely on the same
underlying data and parameters. This includes:</p>
<ul>
<li><strong>Metadata</strong></li>
<li>
<strong>Experimental parameters</strong> (e.g., acceptance criteria,
concentrations)</li>
<li><strong>Measured data</strong></li>
</ul>
<p>Parameters such as acceptance criteria are typically defined by
standard operating procedures (SOPs) and fixed in the spreadsheet
templates. Other values, such as experimental measurements or fitted
parameters, vary per experiment and are entered by the user.</p>
<p>In some cases, it may be beneficial for the script to also use
<strong>calculated data</strong> from the spreadsheet—especially when
those calculations are automatically triggered upon user input. This
decision depends on the specific analysis needs and the reliability of
spreadsheet-based computations.</p>
</div>
<div class="section level2">
<h2 id="structuring-a-template">Structuring a template<a class="anchor" aria-label="anchor" href="#structuring-a-template"></a>
</h2>
<p>To provide a link between the data structures of programming
languages and those in a spreadsheet we consider the following four
types of data structures in a template:</p>
<ul>
<li>
<strong>keyvalue</strong>: a key-value pair, where the key is a
variable name and the value is the value of that variable. The key and
value are placed in horizontally adjacent cells (columns). The key, or
its translated short name (see below) is to be used as the parameter
name in the scripts and should conform to variable naming rules for the
scripting language used. The key is found in the left-most cell of a
cell range. The value can be a single value (one cell) or a vector of
values (multiple cells).</li>
<li>
<strong>cells</strong>: occasionally it may be more convenient to
read values from single cells and provide the keys (names) of the
corresponding variables in the data guide. These data will be stored as
key-value pairs, but in contrast to the <strong>keyvalue</strong> data
type where a variable name is provided in the template the data guide
must provide a variable name.</li>
<li>
<strong>table</strong>: tabular data where columns represent
variables and rows represent items in which these variables are
assessed. Column names are written in the first row and are used as
variable names.</li>
<li>
<strong>platedata</strong>: data are registered in the same
row-column format as the microplate in which the experiment was
performed. The first row contains the variable name in its left-most
cell, and is followed by (integer) column names. Every subsequent row
contains the row name (in capital letters) followed by the values for
each well. Both variable name and data are read by the script. The
column and row names are ignored. Therefore, the first row and column in
the range could also be empty, except for the variable name. Plate data
are stored as tables in which, apart from the variables provided in the
template two additional columns are added, namely row and column,
corresponding to the row and column in a microplate.</li>
</ul>
<p>Below is an example of the front page of a template (of the fitc-t4
TTR assay), illustrating a number of ideas and concepts that we discuss
below.</p>
<div class="figure">
<img src="images%2Ftemplate_frontpage.png" alt="First page of a template" width="100%"><p class="caption">
First page of a template
</p>
</div>
<div class="section level3">
<h3 id="a-template-has-a-version-number">A template has a version number<a class="anchor" aria-label="anchor" href="#a-template-has-a-version-number"></a>
</h3>
<p>Unique template version numbers are a way to prevent
misunderstandings between users and are also needed here to check
whether a data guide is compatible with the template version.</p>
<p><strong>Version numbering rules</strong>. We follow the R-package
version rules. A version number has the structure <kbd>major.minor</kbd>
or <kbd>major.minor.patch</kbd>, where <kbd>major</kbd>,
<kbd>minor</kbd> and <kbd>patch</kbd> are each integer values. A version
consisting of only a major number is invalid, but will be interpreted as
having a minor version <kbd>0</kbd>, <em>i.e.</em> a version
“<kbd>2</kbd>” will be interpreted as “<kbd>2.0</kbd>”.</p>
<p>In practice this means that the format of the cell in which the
version number is recorded should be <em>text</em>, and not
<em>general</em> or <em>number</em></p>
<p><strong>A template name is optional</strong>. Preferably, a template
also has a name. Note that the example in the figure above doesn’t have
a name.</p>
<p><strong>Checking compatibilty of template versions and a guide
version</strong>. We use template version numbers to check compatibility
with a guide. In principle the same guide can be used for multiple
versions of a template as long as the locations and names of variables
indexed in the guide did not change. This is the case when, for example,
only explanatory texts or calculations or data validity checks have
changed in the template. When checking version compatibility we assume
that a guide is compatible with a consecutive range of template versions
between a minimal and a maximal version number.</p>
</div>
<div class="section level3">
<h3 id="all-cells-are-protected-except-those-for-data-entry">All cells are protected except those for data entry<a class="anchor" aria-label="anchor" href="#all-cells-are-protected-except-those-for-data-entry"></a>
</h3>
<p>Data entry cells have a distinct background color, here “marker
yellow”. All other cells have protected status to prevent users from
inadvertently changing them.</p>
</div>
<div class="section level3">
<h3 id="include-comments">Include comments<a class="anchor" aria-label="anchor" href="#include-comments"></a>
</h3>
<p>Refer to the SOP+ version</p>
</div>
<div class="section level3">
<h3 id="built-in-data-entry-checks">Built-in data entry checks<a class="anchor" aria-label="anchor" href="#built-in-data-entry-checks"></a>
</h3>
<p>The validity of data entered by the users should be checked by
validity checks, especially when misunderstandings are likely to happen.
The validity checking capability by excel is limited. In cases where the
data structure can not be properly described by a validity rule we add a
comment next to the cell in which the data is entered.</p>
</div>
<div class="section level3">
<h3 id="a-single-source-of-parameters">A single source of parameters<a class="anchor" aria-label="anchor" href="#a-single-source-of-parameters"></a>
</h3>
<div class="figure" style="text-align: center">
<img src="images%2Fparameters.png" alt="The parameters as key-value pairs" width="40%"><p class="caption">
The parameters as key-value pairs
</p>
</div>
<p>Parameters needed for calculations, for example for acceptance
criteria of measurements are best entered on a separate sheet, and
referred to by absolute references in calculations. In the case of the
example we have a separate hidden sheet called *_parameters* for this
purpose. The information in this sheet is indexed in the data guide, and
therefore available to R-scripts as well.</p>
</div>
<div class="section level3">
<h3 id="use-of-hidden-worksheets-for-data-transfer">Use of hidden worksheets for data transfer<a class="anchor" aria-label="anchor" href="#use-of-hidden-worksheets-for-data-transfer"></a>
</h3>
<div class="figure" style="text-align: center">
<img src="images%2Fdata.png" alt="A hidden sheet with links to plate-formatted data" width="100%"><p class="caption">
A hidden sheet with links to plate-formatted data
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="what-else">What else?<a class="anchor" aria-label="anchor" href="#what-else"></a>
</h2>
<p>The keyvalue format will be mostly used for metadata and parameters.
All keyvalue will be aggregated in a single named list called
“keyvalue”.</p>
<p>The platedata format will be used for measured data and data
concerning concentrations in the plate wells. All ranges will be
aggregated in a single data frame with reported variables as column
names, including the column names “row” and “col”, corresponding to the
row and column names of the plate.</p>
</div>
<div class="section level2">
<h2 id="constructing-a-guide">Constructing a guide<a class="anchor" aria-label="anchor" href="#constructing-a-guide"></a>
</h2>
<p>Every spreadsheet template should be accompanied by a data guide, and
index registering the location of different data structures in the
template. This guide is a yaml file, a human editable and computer
readable file format.</p>
<p>Below is an example of the first rows of a data guide:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">guide.version</span><span class="kw">:</span><span class="at"> </span><span class="st">'1.0'</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">template.name</span><span class="kw">:</span><span class="at"> competition</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">template.min.version</span><span class="kw">:</span><span class="at"> </span><span class="st">'9.3'</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">template.max.version</span><span class="kw">:</span><span class="at"> </span><span class="ch">~</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">plate.format</span><span class="kw">:</span><span class="at"> </span><span class="dv">96</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">locations</span><span class="kw">:</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">sheet</span><span class="kw">:</span><span class="at"> description</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> cells</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="at">    </span><span class="fu">varname</span><span class="kw">:</span><span class="at"> .template</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="at">    </span><span class="fu">translate</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="at">    </span><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> version</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="at">        </span><span class="fu">cell</span><span class="kw">:</span><span class="at"> B2</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">sheet</span><span class="kw">:</span><span class="at"> description</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> keyvalue</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="at">    </span><span class="fu">translate</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="at">    </span><span class="fu">atomicclass</span><span class="kw">:</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> date</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> numeric</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> character</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="at">    </span><span class="fu">varname</span><span class="kw">:</span><span class="at"> metadata</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="at">    </span><span class="fu">ranges</span><span class="kw">:</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> A10:B21</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> A24:B25</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co"># remainder not shown</span></span></code></pre></div>
<p>A guide must contain the following elements:</p>
<div class="section level3">
<h3 id="required-elements">Required elements<a class="anchor" aria-label="anchor" href="#required-elements"></a>
</h3>
<ul>
<li>
<kbd>guide.version</kbd>: the version of the guide</li>
<li>
<kbd>template.name</kbd>: a name for the template</li>
<li>
<kbd>template.min.version</kbd>: The minimal version of the template
for which the guide can be used with the guide</li>
<li>
<kbd>template.max.version</kbd>: The maximal version of the template
for which the guide can be used.</li>
<li>
<kbd>locations</kbd>: the object containing the data locations</li>
<li>
<kbd>translations</kbd>: the object containing the translations of
variable names. Translations can be used both from extended (‘long’)
format to short format and from short to long format. Two functions are
provided by the package to perform these translations <em>vice
versa</em>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="conditionally-required-element">Conditionally required element:<a class="anchor" aria-label="anchor" href="#conditionally-required-element"></a>
</h3>
<ul>
<li>
<kbd>plate.format</kbd> the format of the microplates used for the
experiments. This must be either of ‘24’, ‘48’, ‘96’, or ‘384’. This is
required when a <strong>platedata</strong> element occurs in the
<strong>locations</strong>. This plate format is used to check the
correctness of dimensions of the ranges of <strong>platedata</strong>
elements.</li>
</ul>
<p>The elements in <strong>locations</strong> indicate where data are to
be found, whereas the translation part contains translations between
long and short names for variables. Short names are used as variable
names in the scripts, whereas long names may be used in the spreadsheet,
in particular when these are visible to the user. In that case the names
should be translated before using them in the script. Reverse
translations may be used by the script in the output document.</p>
</div>
</div>
<div class="section level2">
<h2 id="locations">Locations<a class="anchor" aria-label="anchor" href="#locations"></a>
</h2>
<div class="section level3">
<h3 id="required-elements-1">Required elements<a class="anchor" aria-label="anchor" href="#required-elements-1"></a>
</h3>
<ul>
<li>
<kbd>sheet</kbd>: the name of the sheet in which the data are to be
found.</li>
<li>
<kbd>type</kbd>: the format of the data in the range.</li>
<li>
<kbd>translate</kbd>: (<em>true</em>, <em>false</em>) whether the
variable names should be translated before use in the script.</li>
<li>
<kbd>varname</kbd>: the name of the variable in which the data will
be available in the script.</li>
<li>
<kbd>ranges</kbd>: an array of ranges in which the data are to be
found.</li>
</ul>
</div>
<div class="section level3">
<h3 id="optional-element">Optional element<a class="anchor" aria-label="anchor" href="#optional-element"></a>
</h3>
<ul>
<li>
<kbd>atomicclass</kbd>: the class of the data in the ranges, Can
have values “character”, “numeric”, “integer”, “logical” or “date”., It
can.be either a singleton or an array of class of the same length as the
number of ranges. If a singleton then by default all values are
converted to character. If an atomicclass is given then values are
coerced. Coercion is performed by the functions
<code>as.character</code>, <code>as.numeric</code>,
<code>as.integer</code>, <code>as.logical</code>, respectively, or in
case of a date, by a function that produces a Date object.</li>
</ul>
</div>
<div class="section level3">
<h3 id="checking-against-the-exceldataguide-json-schema">Checking against the excelDataGuide json schema<a class="anchor" aria-label="anchor" href="#checking-against-the-exceldataguide-json-schema"></a>
</h3>
<p>Correctness of the structure and syntax of a YAML file like a data
guide can be checked against a JSON schema (See <a href="https://json-schema-everywhere.github.io/yaml" class="external-link">json-schema-everywhere</a>).
We provide a JSON schema called <kbd>excelguide_schema.json</kbd> in the
folder <kbd>data-raw</kbd>. We use the <a href="https://www.npmjs.com/package/pajv" class="external-link">Polyglottal JSON Schema
Validator</a> to validate guides against this schema.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Douwe Molenaar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
